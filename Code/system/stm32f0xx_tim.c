#include "stm32f0xx_tim.h"



void TIMConfig(){
		
	/*enable clock for TIM15/16/17*/
	RCC->APB2ENR |= RCC_APB2ENR_TIM15EN|RCC_APB2ENR_TIM16EN|RCC_APB2ENR_TIM17EN;
	/*enable clock for TIM3/6/14*/
	RCC->APB1ENR |= RCC_APB1ENR_TIM3EN|RCC_APB1ENR_TIM6EN|RCC_APB1ENR_TIM14EN;
	
	TIM15->PSC = TIMER_PSC_1;
	/*select TI1 for TIM15_CH1*/
	TIM15->CCMR1 |= TIM_CCMR1_CC1S_0;	
	TIM15->CCMR1 &= ~(TIM_CCMR1_IC1F | TIM_CCMR1_IC1PSC);
	TIM15->CCMR1 |= TIM_CCMR1_IC1F_0|TIM_CCMR1_IC1F_1;
	TIM15->DIER |= TIM_DIER_CC1DE ;
  	TIM15->CCER &= ~TIM_CCER_CC1P;
  	TIM15->CCER |= TIM_CCER_CC1E;         
	TIM16->PSC = TIMER_PSC_1;
	TIM16->CCMR1 |= TIM_CCMR1_CC1S_0;
	TIM16->CCMR1 &= ~(TIM_CCMR1_IC1F | TIM_CCMR1_IC1PSC);
	TIM16->CCMR1 |= TIM_CCMR1_IC1F_0|TIM_CCMR1_IC1F_1;
	TIM16->DIER |= TIM_DIER_CC1DE ;
	TIM16->CCER &= ~TIM_CCER_CC1P;
	TIM16->CCER |= TIM_CCER_CC1E;   
 	TIM17->PSC = TIMER_PSC_1;
	TIM17->CCMR1 |= TIM_CCMR1_CC1S_0;
	TIM17->CCMR1 &= ~(TIM_CCMR1_IC1F | TIM_CCMR1_IC1PSC);
	TIM17->CCMR1 |= TIM_CCMR1_IC1F_0|TIM_CCMR1_IC1F_1;
	TIM17->DIER |= TIM_DIER_CC1DE ;
  	TIM17->CCER &= ~TIM_CCER_CC1P;
  	TIM17->CCER |= TIM_CCER_CC1E; 

	TIM3->PSC = TIMER_PSC_1;
	TIM6->PSC = TIMER_PSC_1;
	TIM14->PSC= TIMER_PSC_1;
}

/*enable and disable timers for frequency conversion with CCP module*/
void EnableGeneralTimers()
{
	
	TIM15->CR1 |= TIM_CR1_CEN; 
	TIM16->CR1 |= TIM_CR1_CEN;
	TIM17->CR1 |= TIM_CR1_CEN;

	TIM15->CCER |= TIM_CCER_CC1E;
	TIM16->CCER |= TIM_CCER_CC1E;	
	TIM17->CCER |= TIM_CCER_CC1E;
}

void DisableGeneralTimers()
{

	TIM15->CR1 &= ~TIM_CR1_CEN; 
	TIM16->CR1 &= ~TIM_CR1_CEN; 
	TIM17->CR1 &= ~TIM_CR1_CEN;

	TIM15->CCER &= ~TIM_CCER_CC1E;
	TIM16->CCER &= ~TIM_CCER_CC1E;
	TIM17->CCER &= ~TIM_CCER_CC1E;
	
}
